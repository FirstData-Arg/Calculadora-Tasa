<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Calculadora de Tasas</title>
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="calculadora.css" rel="stylesheet">
</head>

<body>

<div class="container">
    <div class="row">
        <div class="col-md-9">
            <h1 class="page-header">Calculadora de Tasas</h1>
        </div>
        <div class="col-md-3">
            <a href="http://www.firstdata.com.ar"><img src="logo.png" class="img-responsive pull-right" alt="Responsive image"></a>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading">Datos</div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-12">
                            <form role="form">
                                <div class="form-group">
                                    <label>Precio de Contado</label>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">$</span>
                                        <input id="precio" type="text" class="form-control" />
                                    </div>
                                    <span class="help-block">Ingrese el precio de contado del producto</span>
                                </div>
                                <div class="form-group">
                                    <label>I.V.A.</label>
                                    <div class="form-group input-group">
                                        <input id="iva" type="text" class="form-control" />
                                        <span class="input-group-addon">%</span>
                                    </div>
                                    <span class="help-block">Ingrese la al√≠cuota de I.V.A. del producto</span>
                                </div>
                                <div class="form-group">
                                    <label>Cantidad de Cuotas</label>
                                    <select class="form-control" id="cuotas">
                                          <option>2</option>
                                          <option>3</option>
                                          <option>4</option>
                                          <option>5</option>
                                          <option>6</option>
                                          <option>7</option>
                                          <option>8</option>
                                          <option>9</option>
                                          <option>10</option>
                                          <option>11</option>
                                          <option>12</option>
                                          <option>13</option>
                                          <option>14</option>
                                          <option>15</option>
                                          <option>16</option>
                                          <option>17</option>
                                          <option>18</option>
                                          <option>19</option>
                                          <option>20</option>
                                          <option>21</option>
                                          <option>22</option>
                                          <option>23</option>
                                          <option>24</option>
                                    </select>
                                    <span class="help-block">Ingrese la cantidad de coutas a pagar el producto</span>
                                </div>
                                <div class="form-group">
                                    <label>T.N.A.</label>
                                    <div class="form-group input-group">
                                        <input id="tna" type="text" class="form-control" />
                                        <span class="input-group-addon">%</span>
                                    </div>
                                    <span class="help-block">Ingrese la T.N.A. (Tasa Nominal Anual) de acuerdo a la cantidad de cuotas y la entidad bancaria</span>
                                </div>
                                <div class="form-inline">
                                    <div class="form-group" align="left">
                                        <button id="limpiar" type="button" class="btn btn-warning">Limpiar</button>
                                    </div>
                                    <div class="form-group pull-right" align="right">
                                        <button id="calcular" type="button" class="btn btn-primary">Calcular</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading">Resultado</div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <p>
                                    <span class="lead">Valor Total en Cuotas: </span><span id="valor_total" class="lead"></span>
                                </p>
                            </div>
                            <div class="form-group">
                                <p>
                                    <span class="lead">Valor de cada Cuota: </span><span id="valor_cuota" class="lead"></span>
                                </p>
                            </div>
                            <div class="form-group">
                                <hr />
                            </div>
                            <div class="form-group">
                                <p>
                                    <span class="lead">T.E.A.: </span><span id="tea" class="lead"></span>
                                    <span class="help-block small">Tasa Efectiva Anual</span>
                                </p>
                            </div>
                            <div class="form-group">
                                <p>
                                    <span class="lead">T.E.M.: </span><span id="tem" class="lead"></span>
                                    <span class="help-block small">Tasa Efectiva Mensual</span>
                                </p>
                            </div>
                            <div class="form-group">
                                <p>
                                    <span class="lead">C.F.T.: </span><span id="cft" class="lead"></span>
                                    <span class="help-block small">Costo Financiero Total</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="jquery.min.js"></script>

<script>

var tna_array = [[1,0],[2,42],[3,42],[4,42],[5,42],[6,42],[7,45],[8,45],[9,45],[10,45],[11,45],[12,45],[13,46],[14,46],[15,46],[16,46],[17,46],[18,46],[19,46],[20,46],[21,46],[22,46],[23,46],[24,46]];

function calcular() {
    var cuotas = $("#cuotas").val().replace(",", ".");
    var tna = $("#tna").val().replace(",", ".") / 100;
    var iva = $("#iva").val().replace(",", ".") / 100;
    var precio = $("#precio").val().replace(",", ".");

    //var tea = (((1 + (tna / cuotas)) ** cuotas) - 1) * 100;
    var tea = (Math.pow((1 + (tna / cuotas)), cuotas) - 1) * 100;
    
    var tem = tna * 100 * 30 / 360;
    //var cft = ((((1 + (tna / cuotas)) ** cuotas) - 1) * (1 + iva)) * 100;
    var cft = ((Math.pow((1 + (tna / cuotas)), cuotas) - 1) * (1 + iva)) * 100;
    var valor_total = precio * (1 + cft / 100);
    var valor_cuota = precio * (1 + cft / 100) / cuotas;
        
    $("#tea").text(tea.toFixed(2) + "%");
    $("#tem").text(tem.toFixed(2) + "%");
    $("#cft").text(cft.toFixed(2) + "%");
    $("#valor_total").text("$" + valor_total.toFixed(2));
    $("#valor_cuota").text("$" + valor_cuota.toFixed(2));
}

$(document).ready(function() {
    $("#calcular").on("click", function() {
        calcular()
    }),
    $("#limpiar").on("click", function() {
        $("#tea").text("");
        $("#tem").text("");
        $("#cft").text("");
        $("#valor_total").text("");
        $("#valor_cuota").text("");
        $("#cuotas").val("1");
        $("#tna").val("");
        $("#iva").val("");
        $("#precio").val("");
    }),
    $("#cuotas").on("change", function() {
        //if ($("#tna").val() == "") {
            $("#tna").val(tna_array[$("#cuotas").val()][1]);
        //}
    })
});
</script>

</body>

</html>
